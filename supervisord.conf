[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

[program:plantuml-server]
command=java %(ENV_JAVA_OPTS)s -jar /opt/plantuml/plantuml.jar -Djava.net.preferIPv4Stack=true -Djetty.http.port=8080
directory=/opt/plantuml
autostart=true
autorestart=true
startretries=3
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=100

[program:mcp-server]
command=node /usr/local/lib/node_modules/plantuml-mcp-server/dist/plantuml-mcp-server.js
directory=/opt/mcp
autostart=true
autorestart=true
startretries=3
environment=PLANTUML_SERVER_URL="%(ENV_PLANTUML_SERVER_URL)s",NODE_ENV="production"
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=200
# MCP server starts after PlantUML server (higher priority number = later start)
